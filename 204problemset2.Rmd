---
title: "204problemset2"
author: "Claire Madden"
date: "4/25/2019"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#set up 
library(tidyverse)

#read in data
gasdata <- read_csv("Gas_Data.csv")

#change column headers to be more simple
names(gasdata) <- c("price", "q_low", "q_high")


```


1. What is the aggregate daily demand curve for gasoline in France? What is the supply curve for gasoline? What is the “benefit” to consumers under the status quo? What is the “benefit” to producers under the status quo? What is the environmental cost under the status quo?

```{r}
#need to find: high demand curve, low demand curve, aggregate demand curve, supply curve (mpc), environmental cost curve (mec), 

#high linear model demand curve:

d_high <- lm(price ~ q_high, data = gasdata)
summary(d_high)
#p=a(q)+b
#p= -0.0001297(q) + 23.39

#saving output numbers for use later
a_high <- d_high$coefficients[2]
b_high <- d_high$coefficients[1]

#high demand curve function
demand_high <- function(x){a_high*x + b_high}



#low demand curve:

d_low <- lm(price ~ q_low, data = gasdata)
summary(d_low)
#p=a(q)+b
#p= -0.0001355(q) + 21.99

#saving output numbers for use later
a_low <- d_low$coefficients[2]
b_low <- d_low$coefficients[1]

#low demand curve function

demand_low <- function(x){a_low*x + b_low}

#graph both demand functions on the same axes
highlowdemand <- ggplot(data.frame(x = c(7000, 500000)), aes(x = x)) +
  stat_function(fun = demand_low, color = "cadetblue3") +
  stat_function(fun = demand_high, color = "red3")+
  scale_y_continuous(limits = c(0,30), expand = c(0,0))+
  scale_x_continuous(limits = c(0,200000), expand = c(0,0))

highlowdemand



#need to know what q equals when p is 21.99085 for aggregate demand curve




#supply curve (mpc)
#p

```






